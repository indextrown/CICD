# This workflow will build a Swift project
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-swift

# CI(Continuous Integration)
#- ì§€ì†ì ì¸ í†µí•©
#- ë²„ê·¸ ìˆ˜ì •ì´ë‚˜ ìƒˆë¡œ ë§Œë“œëŠ” ê¸°ëŠ¥ë“¤ì´ íŠ¹ì • repositoryì— ì£¼ê¸°ì ìœ¼ë¡œ ë¹Œë“œë˜ê³  í…ŒìŠ¤íŠ¸ë˜ì–´ì„œ merge ë˜ëŠ” ê²ƒì´ë‹¤.
#- ê°œë°œìë“¤ì€ ì½”ë“œ ë³€ê²½ì‚¬í•­ì„ ì£¼ê¸°ì ìœ¼ë¡œ merge í•´ì•¼í•œë‹¤.
#- ì£¼ê¸°ì ìœ¼ë¡œ mergeëœ ì½”ë“œì˜ ë³€ê²½ì‚¬í•­ì´ ìë™ìœ¼ë¡œ ë¹Œë“œë˜ì–´ Build ì„±ê³µ ìœ ë¬´ë¥¼ í™•ì¸í•´ì•¼í•œë‹¤.
#- ê¸°ì¡´ì˜ ì‹œìŠ¤í…œì— ë‹¤ë¥¸ ë²„ê·¸ë¥¼ ì´ˆë˜í•˜ì§€ ì•Šì•˜ëŠ”ì§€ ìë™ìœ¼ë¡œ Testê¹Œì§€ ë˜ì–´ì•¼ í•œë‹¤.

# ì›Œí¬í”Œë¡œìš° ì´ë¦„
name: CI

# íŠ¸ë¦¬ê±° ì¡°ê±´(on)
# push: main ë¸Œëœì¹˜ì— push ì´ë²¤íŠ¸ ë°œìƒì‹œ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
# push requset: main ë¸Œëœì¹˜ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” pull requestê°€ ìƒì„±ë˜ê±°ë‚˜ ì—…ë°ì´íŠ¸ì‹œ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

# ì‘ì—… ì •ì˜
jobs:
  build:
    # ì‘ì—…ì´ ì‹¤í–‰ë  í™˜ê²½ì„ ì§€ì •
    runs-on: macos-latest

    # ì›Œí¬í”Œë¡œìš° ë‹¨ê³„(Steps) ì •ì˜
    steps:
    
    # 1. ë¦¬í¬ì§€í† ë¦¬ ì²´í¬ì•„ì›ƒ ë‹¨ê³„ - GitHubì˜ ê³µì‹ checkout ì•¡ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬í¬ì§€í† ë¦¬ì˜ ì½”ë“œë¥¼ ì›Œí¬í”Œë¡œìš° í™˜ê²½ì„ ê°€ì ¸ì˜¨ë‹¤.
    - uses: actions/checkout@v4
    
    # 2. ì§€ì •í•œ Xcode ë²„ì „ìœ¼ë¡œ í™˜ê²½ ì„¤ì •
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: "16.1.0"
    
    # 3. ë¹Œë“œë‹¨ê³„ - Buildë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì´ ë‹¨ê³„ë¥¼ ì‹ë³„, -v ì˜µì…˜ìœ¼ë¡œ ë¹Œë“œ ê³¼ì • ìƒì„¸íˆ ì¶œë ¥
    - name: Start xcode build ğŸ› 
      run: |
        xcodebuild clean build \
          -project CI-CD.xcodeproj \
          -scheme CI-CD \
          -destination "platform=iOS Simulator,name=iPhone 15 Pro Max,OS=17.5"
      
    # 4. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë‹¨ê³„ - swift test -v ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Swift í”„ë¡œì íŠ¸ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰
#      - name: Run tests
#        run: |
#          xcodebuild clean test \
#            -project CI-CD.xcodeproj \
#            -scheme CI-CD \
#            -destination "platform=iOS Simulator,name=iPhone 15 Pro Max,OS=17.5"
